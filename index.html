<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Beginner ‚Üí Elementary: 20 —É—Ä–æ–∫–æ–≤</title>
<style>
:root{
  --dark-bg:#1a1b23; --dark-card:#252836; --dark-text:#e6e9ef; --accent:#34d399; --accent2:#60a5fa;
  --muted:#0f1220; --radius:14px; --t:.25s;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;background:var(--dark-bg);color:var(--dark-text);min-height:100vh;display:flex;flex-direction:column}
header{display:flex;justify-content:space-between;align-items:center;padding:18px 20px;gap:10px;flex-wrap:wrap}
h1{font-size:22px}
main{flex:1;display:flex;flex-direction:column;gap:16px;padding:16px}

.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:14px}
.card{background:var(--dark-card);border-radius:var(--radius);padding:16px;display:flex;flex-direction:column;gap:10px;transition:transform var(--t), box-shadow var(--t)}
.card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.35)}
.card.locked{opacity:.55;pointer-events:none}
.title{font-weight:700}
.subtitle{opacity:.8;font-size:14px}
.progress{height:8px;background:var(--muted);border-radius:999px;overflow:hidden}
.progress .fill{height:100%;width:0%;background:var(--accent);transition:width .3s}
.row{display:flex;align-items:center;justify-content:space-between;gap:8px}
.badge{font-size:12px;opacity:.85}

.button{cursor:pointer;border:none;border-radius:12px;padding:10px 14px;background:var(--accent2);color:#fff;font-weight:600;transition:opacity var(--t), transform var(--t)}
.button:hover{opacity:.9;transform:translateY(-1px)}

.section{display:none}
.section.active{display:block}

.panel{background:var(--dark-card);border-radius:var(--radius);padding:16px}
.words{margin:10px 0 16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:8px;font-size:15px;opacity:.95}
.word{padding:8px 10px;background:#1d2030;border-radius:10px}

#testPrompt{font-size:28px;margin-bottom:12px}
input[type="text"]{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #3a3d52;background:#1d2030;color:#fff;font-size:16px;outline:none}
.controls{display:flex;gap:10px;margin-top:10px}
.feedback{margin-top:10px;padding:10px;border-radius:10px;display:none}
.feedback.correct{background:rgba(52,211,153,.18);color:#34d399}
.feedback.wrong{background:rgba(248,113,113,.18);color:#f87171}

.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
.back{opacity:.85}
hr{border:none;height:1px;background:#34384e;margin:10px 0}
.small{font-size:13px;opacity:.8}
</style>
</head>
<body>
<header>
  <h1>English A1: Beginner ‚Üí Elementary (20 —É—Ä–æ–∫–æ–≤)</h1>
  <div style="display:flex;gap:10px;align-items:center">
    <button id="langBtn" class="button">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
    <button id="resetBtn" class="button back">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
  </div>
</header>

<main>
  <!-- –°–ü–ò–°–û–ö –£–†–û–ö–û–í -->
  <section id="mainPage" class="section active">
    <div id="lessonsGrid" class="grid"></div>
  </section>

  <!-- –£–†–û–ö (–¢–ï–û–†–ò–Ø) -->
  <section id="lessonPage" class="section">
    <div class="panel">
      <div class="row"><h2 id="lessonTitle"></h2><span class="badge small" id="lessonBadge"></span></div>
      <hr/>
      <div id="wordList" class="words"></div>
      <div class="actions">
        <button id="startTestBtn" class="button">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –ø–æ —Ç–µ–º–µ</button>
        <button id="backToMain1" class="button back">‚Üê –ù–∞–∑–∞–¥ –∫ —É—Ä–æ–∫–∞–º</button>
      </div>
    </div>
  </section>

  <!-- –¢–ï–°–¢ -->
  <section id="testPage" class="section">
    <div class="panel">
      <div class="row"><h2>–¢–µ—Å—Ç</h2><span class="badge small" id="testPos"></span></div>
      <hr/>
      <div id="testPrompt"></div>
      <form id="testForm">
        <input id="testInput" type="text" autocomplete="off" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π"/>
        <div class="controls">
          <button class="button" type="submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <button class="button back" type="button" id="skipBtn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
        </div>
      </form>
      <div id="testFeedback" class="feedback"></div>
      <div class="actions" style="margin-top:12px">
        <button id="stopTestBtn" class="button back" type="button">–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è</button>
      </div>
    </div>
  </section>

  <!-- –†–ï–ó–£–õ–¨–¢–ê–¢ -->
  <section id="summaryPage" class="section">
    <div class="panel">
      <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ–º—ã</h2>
      <hr/>
      <p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ: <b id="sumCorrect">0</b></p>
      <p>–û—à–∏–±–∫–∏: <b id="sumWrong">0</b></p>
      <p>–ü—Ä–æ—Ü–µ–Ω—Ç: <b id="sumPercent">0%</b></p>
      <div class="actions">
        <button id="againBtn" class="button">–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</button>
        <button id="backToMain2" class="button back">‚Üê –ö —É—Ä–æ–∫–∞–º</button>
      </div>
    </div>
  </section>
</main>

<script>
// ====== –Ø–ó–´–ö (RU ‚Üî UZ) ======
let currentLang = localStorage.getItem("a1_lang") || "ru"; // 'ru' –∏–ª–∏ 'uz'
const langBtn = document.getElementById("langBtn");
function setLangUI(){
  langBtn.textContent = currentLang === "ru" ? "üá∑üá∫ –†—É—Å—Å–∫–∏–π" : "üá∫üáø O‚Äòzbekcha";
  // –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –¥–ª—è –∏–Ω–ø—É—Ç–∞
  testInput.setAttribute(
    "placeholder",
    currentLang === "ru" ? "–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π" : "Inglizcha tarjimani kiriting"
  );
  // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π —É—Ä–æ–∫/—Ç–µ—Å—Ç, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç
  if (lessonPage.classList.contains("active")) openLesson(currentLessonIndex);
  if (testPage.classList.contains("active")) renderTestWord();
}
langBtn.addEventListener("click", ()=>{
  currentLang = currentLang === "ru" ? "uz" : "ru";
  localStorage.setItem("a1_lang", currentLang);
  setLangUI();
});

// ====== –î–ê–ù–ù–´–ï (20 —Ç–µ–º, RU + UZ) ======
let lessons = [
  { title:"–£—Ä–æ–∫ 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ", words:[
    {en:"Hello",ru:"–ø—Ä–∏–≤–µ—Ç",uz:"salom"},
    {en:"Hi",ru:"–ø—Ä–∏–≤–µ—Ç",uz:"salom"},
    {en:"Good morning",ru:"–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ",uz:"xayrli tong"},
    {en:"Good afternoon",ru:"–¥–æ–±—Ä—ã–π –¥–µ–Ω—å",uz:"xayrli kun"},
    {en:"Good evening",ru:"–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä",uz:"xayrli kech"},
    {en:"Good night",ru:"—Å–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏",uz:"xayrli tun"},
    {en:"How are you?",ru:"–∫–∞–∫ –¥–µ–ª–∞",uz:"qalaysiz?"},
    {en:"I'm fine",ru:"—è –≤ –ø–æ—Ä—è–¥–∫–µ",uz:"men yaxshiman"},
    {en:"What's your name?",ru:"–∫–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç",uz:"ismingiz nima?"},
    {en:"My name is...",ru:"–º–µ–Ω—è –∑–æ–≤—É—Ç",uz:"mening ismim ..."},
    {en:"Nice to meet you",ru:"–ø—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è",uz:"tanishganimdan xursandman"},
    {en:"Goodbye",ru:"–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è",uz:"xayr"},
    {en:"See you",ru:"—É–≤–∏–¥–∏–º—Å—è",uz:"ko‚Äòrishguncha"},
    {en:"Thank you",ru:"—Å–ø–∞—Å–∏–±–æ",uz:"rahmat"},
    {en:"You're welcome",ru:"–ø–æ–∂–∞–ª—É–π—Å—Ç–∞",uz:"arzimaydi"},
    {en:"Excuse me",ru:"–∏–∑–≤–∏–Ω–∏—Ç–µ",uz:"kechirasiz"},
    {en:"Sorry",ru:"–ø—Ä–æ—Å—Ç–∏—Ç–µ",uz:"uzr"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 2: –°–µ–º—å—è", words:[
    {en:"Father",ru:"–æ—Ç–µ—Ü",uz:"ota"},
    {en:"Mother",ru:"–º–∞—Ç—å",uz:"ona"},
    {en:"Brother",ru:"–±—Ä–∞—Ç",uz:"aka"},
    {en:"Sister",ru:"—Å–µ—Å—Ç—Ä–∞",uz:"opa"},
    {en:"Son",ru:"—Å—ã–Ω",uz:"o‚Äòg‚Äòil"},
    {en:"Daughter",ru:"–¥–æ—á—å",uz:"qiz"},
    {en:"Parents",ru:"—Ä–æ–¥–∏—Ç–µ–ª–∏",uz:"ota-ona"},
    {en:"Family",ru:"—Å–µ–º—å—è",uz:"oila"},
    {en:"Grandfather",ru:"–¥–µ–¥—É—à–∫–∞",uz:"bobo"},
    {en:"Grandmother",ru:"–±–∞–±—É—à–∫–∞",uz:"buvi"},
    {en:"Husband",ru:"–º—É–∂",uz:"er"},
    {en:"Wife",ru:"–∂–µ–Ω–∞",uz:"xotin"},
    {en:"Uncle",ru:"–¥—è–¥—è",uz:"amaki"},
    {en:"Aunt",ru:"—Ç—ë—Ç—è",uz:"xola"},
    {en:"Cousin",ru:"–¥–≤–æ—é—Ä–æ–¥–Ω—ã–π –±—Ä–∞—Ç/—Å–µ—Å—Ç—Ä–∞",uz:"amakivachcha (qarindosh)"},
    {en:"Relative",ru:"—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫",uz:"qarindosh"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 3: –ß–∏—Å–ª–∞", words:[
    {en:"Zero",ru:"–Ω–æ–ª—å",uz:"nol"},
    {en:"One",ru:"–æ–¥–∏–Ω",uz:"bir"},
    {en:"Two",ru:"–¥–≤–∞",uz:"ikki"},
    {en:"Three",ru:"—Ç—Ä–∏",uz:"uch"},
    {en:"Four",ru:"—á–µ—Ç—ã—Ä–µ",uz:"to‚Äòrt"},
    {en:"Five",ru:"–ø—è—Ç—å",uz:"besh"},
    {en:"Six",ru:"—à–µ—Å—Ç—å",uz:"olti"},
    {en:"Seven",ru:"—Å–µ–º—å",uz:"yetti"},
    {en:"Eight",ru:"–≤–æ—Å–µ–º—å",uz:"sakkiz"},
    {en:"Nine",ru:"–¥–µ–≤—è—Ç—å",uz:"to‚Äòqqiz"},
    {en:"Ten",ru:"–¥–µ—Å—è—Ç—å",uz:"o‚Äòn"},
    {en:"Twenty",ru:"–¥–≤–∞–¥—Ü–∞—Ç—å",uz:"yigirma"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 4: –¶–≤–µ—Ç–∞", words:[
    {en:"Red",ru:"–∫—Ä–∞—Å–Ω—ã–π",uz:"qizil"},
    {en:"Blue",ru:"—Å–∏–Ω–∏–π",uz:"ko‚Äòk"},
    {en:"Green",ru:"–∑–µ–ª—ë–Ω—ã–π",uz:"yashil"},
    {en:"Yellow",ru:"–∂—ë–ª—Ç—ã–π",uz:"sariq"},
    {en:"Black",ru:"—á—ë—Ä–Ω—ã–π",uz:"qora"},
    {en:"White",ru:"–±–µ–ª—ã–π",uz:"oq"},
    {en:"Orange",ru:"–æ—Ä–∞–Ω–∂–µ–≤—ã–π",uz:"to‚Äòq sariq"},
    {en:"Pink",ru:"—Ä–æ–∑–æ–≤—ã–π",uz:"pushti"},
    {en:"Purple",ru:"—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π",uz:"binafsha"},
    {en:"Brown",ru:"–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π",uz:"jigarrang"},
    {en:"Gray",ru:"—Å–µ—Ä—ã–π",uz:"kulrang"},
    {en:"Beige",ru:"–±–µ–∂–µ–≤—ã–π",uz:"bej"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 5: –°—Ç—Ä–∞–Ω—ã –∏ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏", words:[
    {en:"Uzbekistan / Uzbek",ru:"—É–∑–±–µ–∫–∏—Å—Ç–∞–Ω / —É–∑–±–µ–∫",uz:"O‚Äòzbekiston / o‚Äòzbek"},
    {en:"Russia / Russian",ru:"—Ä–æ—Å—Å–∏—è / —Ä—É—Å—Å–∫–∏–π",uz:"Rossiya / rus"},
    {en:"USA / American",ru:"—Å—à–∞ / –∞–º–µ—Ä–∏–∫–∞–Ω–µ—Ü",uz:"AQSH / amerikalik"},
    {en:"UK / British",ru:"–≤–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è / –±—Ä–∏—Ç–∞–Ω–µ—Ü",uz:"Buyuk Britaniya / britaniyalik"},
    {en:"China / Chinese",ru:"–∫–∏—Ç–∞–π / –∫–∏—Ç–∞–µ—Ü",uz:"Xitoy / xitoylik"},
    {en:"India / Indian",ru:"–∏–Ω–¥–∏—è / –∏–Ω–¥–∏–µ—Ü",uz:"Hindiston / hind"},
    {en:"Germany / German",ru:"–≥–µ—Ä–º–∞–Ω–∏—è / –Ω–µ–º–µ—Ü",uz:"Germaniya / nemis"},
    {en:"France / French",ru:"—Ñ—Ä–∞–Ω—Ü–∏—è / —Ñ—Ä–∞–Ω—Ü—É–∑",uz:"Fransiya / fransuz"},
    {en:"Spain / Spanish",ru:"–∏—Å–ø–∞–Ω–∏—è / –∏—Å–ø–∞–Ω–µ—Ü",uz:"Ispaniya / ispan"},
    {en:"Italy / Italian",ru:"–∏—Ç–∞–ª–∏—è / –∏—Ç–∞–ª—å—è–Ω–µ—Ü",uz:"Italiya / italiyalik"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 6: –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏", words:[
    {en:"Doctor",ru:"–¥–æ–∫—Ç–æ—Ä",uz:"shifokor"},
    {en:"Teacher",ru:"—É—á–∏—Ç–µ–ª—å",uz:"o‚Äòqituvchi"},
    {en:"Engineer",ru:"–∏–Ω–∂–µ–Ω–µ—Ä",uz:"muhandis"},
    {en:"Driver",ru:"–≤–æ–¥–∏—Ç–µ–ª—å",uz:"haydovchi"},
    {en:"Nurse",ru:"–º–µ–¥—Å–µ—Å—Ç—Ä–∞",uz:"hamshira"},
    {en:"Police officer",ru:"–ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–π",uz:"politsiya xodimi"},
    {en:"Firefighter",ru:"–ø–æ–∂–∞—Ä–Ω—ã–π",uz:"o‚Äòt o‚Äòchiruvchi"},
    {en:"Chef",ru:"–ø–æ–≤–∞—Ä",uz:"bosh oshpaz"},
    {en:"Farmer",ru:"—Ñ–µ—Ä–º–µ—Ä",uz:"dehqon"},
    {en:"Artist",ru:"—Ö—É–¥–æ–∂–Ω–∏–∫",uz:"rassom"},
    {en:"Worker",ru:"—Ä–∞–±–æ—á–∏–π",uz:"ishchi"},
    {en:"Student",ru:"—Å—Ç—É–¥–µ–Ω—Ç",uz:"talaba"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 7: –î–æ–º –∏ –º–µ–±–µ–ª—å", words:[
    {en:"House",ru:"–¥–æ–º",uz:"uy"},
    {en:"Apartment",ru:"–∫–≤–∞—Ä—Ç–∏—Ä–∞",uz:"kvartira"},
    {en:"Room",ru:"–∫–æ–º–Ω–∞—Ç–∞",uz:"xona"},
    {en:"Kitchen",ru:"–∫—É—Ö–Ω—è",uz:"oshxona"},
    {en:"Bathroom",ru:"–≤–∞–Ω–Ω–∞—è",uz:"yuvinish xonasi"},
    {en:"Bedroom",ru:"—Å–ø–∞–ª—å–Ω—è",uz:"yotoqxona"},
    {en:"Living room",ru:"–≥–æ—Å—Ç–∏–Ω–∞—è",uz:"mehmonxona"},
    {en:"Table",ru:"—Å—Ç–æ–ª",uz:"stol"},
    {en:"Chair",ru:"—Å—Ç—É–ª",uz:"stul"},
    {en:"Bed",ru:"–∫—Ä–æ–≤–∞—Ç—å",uz:"karovat"},
    {en:"Sofa",ru:"–¥–∏–≤–∞–Ω",uz:"divan"},
    {en:"Window",ru:"–æ–∫–Ω–æ",uz:"deraza"},
    {en:"Door",ru:"–¥–≤–µ—Ä—å",uz:"eshik"},
    {en:"Fridge",ru:"—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫",uz:"muzlatgich"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 8: –ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏", words:[
    {en:"Water",ru:"–≤–æ–¥–∞",uz:"suv"},
    {en:"Tea",ru:"—á–∞–π",uz:"choy"},
    {en:"Coffee",ru:"–∫–æ—Ñ–µ",uz:"qahva"},
    {en:"Milk",ru:"–º–æ–ª–æ–∫–æ",uz:"sut"},
    {en:"Bread",ru:"—Ö–ª–µ–±",uz:"non"},
    {en:"Butter",ru:"–º–∞—Å–ª–æ",uz:"sariyog‚Äò"},
    {en:"Cheese",ru:"—Å—ã—Ä",uz:"pishloq"},
    {en:"Egg",ru:"—è–π—Ü–æ",uz:"tuxum"},
    {en:"Rice",ru:"—Ä–∏—Å",uz:"guruch"},
    {en:"Meat",ru:"–º—è—Å–æ",uz:"go‚Äòsht"},
    {en:"Fish",ru:"—Ä—ã–±–∞",uz:"baliq"},
    {en:"Soup",ru:"—Å—É–ø",uz:"sho‚Äòrva"},
    {en:"Apple",ru:"—è–±–ª–æ–∫–æ",uz:"olma"},
    {en:"Banana",ru:"–±–∞–Ω–∞–Ω",uz:"banan"},
    {en:"Orange",ru:"–∞–ø–µ–ª—å—Å–∏–Ω",uz:"apelsin"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 9: –ñ–∏–≤–æ—Ç–Ω—ã–µ", words:[
    {en:"Dog",ru:"—Å–æ–±–∞–∫–∞",uz:"it"},
    {en:"Cat",ru:"–∫–æ—à–∫–∞",uz:"mushuk"},
    {en:"Bird",ru:"–ø—Ç–∏—Ü–∞",uz:"qush"},
    {en:"Cow",ru:"–∫–æ—Ä–æ–≤–∞",uz:"sigir"},
    {en:"Horse",ru:"–ª–æ—à–∞–¥—å",uz:"ot"},
    {en:"Sheep",ru:"–æ–≤—Ü–∞",uz:"qo‚Äòy"},
    {en:"Pig",ru:"—Å–≤–∏–Ω—å—è",uz:"cho‚Äòchqa"},
    {en:"Rabbit",ru:"–∫—Ä–æ–ª–∏–∫",uz:"quyon"},
    {en:"Mouse",ru:"–º—ã—à—å",uz:"sichqon"},
    {en:"Duck",ru:"—É—Ç–∫–∞",uz:"o‚Äòrdak"},
    {en:"Chicken",ru:"–∫—É—Ä–∏—Ü–∞",uz:"tovuq"},
    {en:"Goat",ru:"–∫–æ–∑–∞",uz:"echki"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 10: –í—Ä–µ–º—è –∏ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏", words:[
    {en:"Monday",ru:"–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",uz:"dushanba"},
    {en:"Tuesday",ru:"–≤—Ç–æ—Ä–Ω–∏–∫",uz:"seshanba"},
    {en:"Wednesday",ru:"—Å—Ä–µ–¥–∞",uz:"chorshanba"},
    {en:"Thursday",ru:"—á–µ—Ç–≤–µ—Ä–≥",uz:"payshanba"},
    {en:"Friday",ru:"–ø—è—Ç–Ω–∏—Ü–∞",uz:"juma"},
    {en:"Saturday",ru:"—Å—É–±–±–æ—Ç–∞",uz:"shanba"},
    {en:"Sunday",ru:"–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ",uz:"yakshanba"},
    {en:"Morning",ru:"—É—Ç—Ä–æ",uz:"ertalab"},
    {en:"Afternoon",ru:"–¥–µ–Ω—å",uz:"tushdan keyin"},
    {en:"Evening",ru:"–≤–µ—á–µ—Ä",uz:"kechqurun"},
    {en:"Night",ru:"–Ω–æ—á—å",uz:"tun"},
    {en:"Today",ru:"—Å–µ–≥–æ–¥–Ω—è",uz:"bugun"},
    {en:"Yesterday",ru:"–≤—á–µ—Ä–∞",uz:"kecha"},
    {en:"Tomorrow",ru:"–∑–∞–≤—Ç—Ä–∞",uz:"ertaga"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 11: –ü–æ–≥–æ–¥–∞ –∏ —Å–µ–∑–æ–Ω—ã", words:[
    {en:"Sunny",ru:"—Å–æ–ª–Ω–µ—á–Ω–æ",uz:"quyoshli"},
    {en:"Rainy",ru:"–¥–æ–∂–¥–ª–∏–≤–æ",uz:"yomg‚Äòirli"},
    {en:"Cloudy",ru:"–æ–±–ª–∞—á–Ω–æ",uz:"bulutli"},
    {en:"Windy",ru:"–≤–µ—Ç—Ä–µ–Ω–æ",uz:"shamolli"},
    {en:"Snowy",ru:"—Å–Ω–µ–∂–Ω–æ",uz:"qorli"},
    {en:"Hot",ru:"–∂–∞—Ä–∫–æ",uz:"issiq"},
    {en:"Cold",ru:"—Ö–æ–ª–æ–¥–Ω–æ",uz:"sovuq"},
    {en:"Warm",ru:"—Ç–µ–ø–ª–æ",uz:"iliq"},
    {en:"Cool",ru:"–ø—Ä–æ—Ö–ª–∞–¥–Ω–æ",uz:"salqin"},
    {en:"Storm",ru:"—à—Ç–æ—Ä–º",uz:"bo‚Äòron"},
    {en:"Fog",ru:"—Ç—É–º–∞–Ω",uz:"tuman"},
    {en:"Spring",ru:"–≤–µ—Å–Ω–∞",uz:"bahor"},
    {en:"Summer",ru:"–ª–µ—Ç–æ",uz:"yoz"},
    {en:"Autumn",ru:"–æ—Å–µ–Ω—å",uz:"kuz"},
    {en:"Winter",ru:"–∑–∏–º–∞",uz:"qish"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 12: –•–æ–±–±–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã", words:[
    {en:"Reading",ru:"—á—Ç–µ–Ω–∏–µ",uz:"o‚Äòqish"},
    {en:"Drawing",ru:"—Ä–∏—Å–æ–≤–∞–Ω–∏–µ",uz:"chizish"},
    {en:"Painting",ru:"–∂–∏–≤–æ–ø–∏—Å—å",uz:"rangtasvir"},
    {en:"Music",ru:"–º—É–∑—ã–∫–∞",uz:"musiqa"},
    {en:"Dancing",ru:"—Ç–∞–Ω—Ü—ã",uz:"raqs"},
    {en:"Singing",ru:"–ø–µ–Ω–∏–µ",uz:"qo‚Äòshiq aytish"},
    {en:"Swimming",ru:"–ø–ª–∞–≤–∞–Ω–∏–µ",uz:"suzish"},
    {en:"Running",ru:"–±–µ–≥",uz:"yugurish"},
    {en:"Cycling",ru:"–≤–µ–ª–æ—Å–ø–æ—Ä—Ç",uz:"velosport"},
    {en:"Traveling",ru:"–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è",uz:"sayohat"},
    {en:"Cooking",ru:"–≥–æ—Ç–æ–≤–∫–∞",uz:"ovqat pishirish"},
    {en:"Photography",ru:"—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è",uz:"suratga olish"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 13: –ë–∞–∑–æ–≤—ã–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã", words:[
    {en:"Go",ru:"–∏–¥—Ç–∏",uz:"bormoq"},
    {en:"Come",ru:"–ø—Ä–∏—Ö–æ–¥–∏—Ç—å",uz:"kelmoq"},
    {en:"Do",ru:"–¥–µ–ª–∞—Ç—å",uz:"qilmoq"},
    {en:"Make",ru:"—Å–æ–∑–¥–∞–≤–∞—Ç—å",uz:"yasamoq"},
    {en:"Have",ru:"–∏–º–µ—Ç—å",uz:"ega bo‚Äòlmoq"},
    {en:"Want",ru:"—Ö–æ—Ç–µ—Ç—å",uz:"xohlamoq"},
    {en:"Need",ru:"–Ω—É–∂–¥–∞—Ç—å—Å—è",uz:"kerak bo‚Äòlmoq"},
    {en:"Like",ru:"–Ω—Ä–∞–≤–∏—Ç—å—Å—è",uz:"yoqtirmoq"},
    {en:"Know",ru:"–∑–Ω–∞—Ç—å",uz:"bilmoq"},
    {en:"Think",ru:"–¥—É–º–∞—Ç—å",uz:"o‚Äòylamoq"},
    {en:"See",ru:"–≤–∏–¥–µ—Ç—å",uz:"ko‚Äòrmoq"},
    {en:"Get",ru:"–ø–æ–ª—É—á–∞—Ç—å",uz:"olmoq"},
    {en:"Give",ru:"–¥–∞–≤–∞—Ç—å",uz:"bermoq"},
    {en:"Use",ru:"–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å",uz:"ishlatmoq"},
    {en:"Work",ru:"—Ä–∞–±–æ—Ç–∞—Ç—å",uz:"ishlamoq"},
    {en:"Live",ru:"–∂–∏—Ç—å",uz:"yashamoq"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 14: –®–∫–æ–ª–∞ –∏ —É—á—ë–±–∞", words:[
    {en:"School",ru:"—à–∫–æ–ª–∞",uz:"maktab"},
    {en:"Teacher",ru:"—É—á–∏—Ç–µ–ª—å",uz:"o‚Äòqituvchi"},
    {en:"Student",ru:"—É—á–µ–Ω–∏–∫",uz:"o‚Äòquvchi"},
    {en:"Class",ru:"–∫–ª–∞—Å—Å",uz:"sinf"},
    {en:"Lesson",ru:"—É—Ä–æ–∫",uz:"dars"},
    {en:"Homework",ru:"–¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ",uz:"uy vazifasi"},
    {en:"Book",ru:"–∫–Ω–∏–≥–∞",uz:"kitob"},
    {en:"Notebook",ru:"—Ç–µ—Ç—Ä–∞–¥—å",uz:"daftar"},
    {en:"Pen",ru:"—Ä—É—á–∫–∞",uz:"ruchka"},
    {en:"Pencil",ru:"–∫–∞—Ä–∞–Ω–¥–∞—à",uz:"qalam"},
    {en:"Ruler",ru:"–ª–∏–Ω–µ–π–∫–∞",uz:"lineyka"},
    {en:"Eraser",ru:"–ª–∞—Å—Ç–∏–∫",uz:"o‚Äòchirg‚Äòich"},
    {en:"Desk",ru:"–ø–∞—Ä—Ç–∞",uz:"parta"},
    {en:"Chair",ru:"—Å—Ç—É–ª",uz:"stul"},
    {en:"Blackboard",ru:"–¥–æ—Å–∫–∞",uz:"doska"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 15: –ì–æ—Ä–æ–¥ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç", words:[
    {en:"City",ru:"–≥–æ—Ä–æ–¥",uz:"shahar"},
    {en:"Town",ru:"–≥–æ—Ä–æ–¥–æ–∫",uz:"shaharcha"},
    {en:"Village",ru:"–¥–µ—Ä–µ–≤–Ω—è",uz:"qishloq"},
    {en:"Street",ru:"—É–ª–∏—Ü–∞",uz:"ko‚Äòcha"},
    {en:"Park",ru:"–ø–∞—Ä–∫",uz:"bog‚Äò"},
    {en:"Shop",ru:"–º–∞–≥–∞–∑–∏–Ω",uz:"do‚Äòkon"},
    {en:"Market",ru:"—Ä—ã–Ω–æ–∫",uz:"bozor"},
    {en:"Bank",ru:"–±–∞–Ω–∫",uz:"bank"},
    {en:"Post office",ru:"–ø–æ—á—Ç–∞",uz:"pochta"},
    {en:"Hospital",ru:"–±–æ–ª—å–Ω–∏—Ü–∞",uz:"shifoxona"},
    {en:"Hotel",ru:"–æ—Ç–µ–ª—å",uz:"mehmonxona"},
    {en:"Bus",ru:"–∞–≤—Ç–æ–±—É—Å",uz:"avtobus"},
    {en:"Car",ru:"–º–∞—à–∏–Ω–∞",uz:"mashina"},
    {en:"Taxi",ru:"—Ç–∞–∫—Å–∏",uz:"taksi"},
    {en:"Train",ru:"–ø–æ–µ–∑–¥",uz:"poyezd"},
    {en:"Subway",ru:"–º–µ—Ç—Ä–æ",uz:"metro"},
    {en:"Airport",ru:"–∞—ç—Ä–æ–ø–æ—Ä—Ç",uz:"aeroport"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 16: –û–¥–µ–∂–¥–∞", words:[
    {en:"Shirt",ru:"—Ä—É–±–∞—à–∫–∞",uz:"ko‚Äòylak"},
    {en:"T-shirt",ru:"—Ñ—É—Ç–±–æ–ª–∫–∞",uz:"futbolka"},
    {en:"Sweater",ru:"—Å–≤–∏—Ç–µ—Ä",uz:"sviter"},
    {en:"Jacket",ru:"–∫—É—Ä—Ç–∫–∞",uz:"kurtka"},
    {en:"Coat",ru:"–ø–∞–ª—å—Ç–æ",uz:"palto"},
    {en:"Jeans",ru:"–¥–∂–∏–Ω—Å—ã",uz:"jinsi"},
    {en:"Pants",ru:"–±—Ä—é–∫–∏",uz:"shim"},
    {en:"Dress",ru:"–ø–ª–∞—Ç—å–µ",uz:"libos (ko‚Äòylak)"},
    {en:"Skirt",ru:"—é–±–∫–∞",uz:"yubka"},
    {en:"Shoes",ru:"–æ–±—É–≤—å",uz:"poyabzal"},
    {en:"Boots",ru:"–±–æ—Ç–∏–Ω–∫–∏",uz:"etik"},
    {en:"Socks",ru:"–Ω–æ—Å–∫–∏",uz:"paypoq"},
    {en:"Hat",ru:"—à–ª—è–ø–∞",uz:"shlyapa"},
    {en:"Scarf",ru:"—à–∞—Ä—Ñ",uz:"sharf"},
    {en:"Gloves",ru:"–ø–µ—Ä—á–∞—Ç–∫–∏",uz:"qo‚Äòlqop"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 17: –ú–∞–≥–∞–∑–∏–Ω—ã –∏ –ø–æ–∫—É–ø–∫–∏", words:[
    {en:"Buy",ru:"–ø–æ–∫—É–ø–∞—Ç—å",uz:"sotib olmoq"},
    {en:"Sell",ru:"–ø—Ä–æ–¥–∞–≤–∞—Ç—å",uz:"sotmoq"},
    {en:"Price",ru:"—Ü–µ–Ω–∞",uz:"narx"},
    {en:"Cheap",ru:"–¥–µ—à—ë–≤—ã–π",uz:"arzon"},
    {en:"Expensive",ru:"–¥–æ—Ä–æ–≥–æ–π",uz:"qimmat"},
    {en:"Cash",ru:"–Ω–∞–ª–∏—á–Ω—ã–µ",uz:"naqd pul"},
    {en:"Card",ru:"–∫–∞—Ä—Ç–∞",uz:"karta"},
    {en:"Receipt",ru:"—á–µ–∫",uz:"chek"},
    {en:"Discount",ru:"—Å–∫–∏–¥–∫–∞",uz:"chegirma"},
    {en:"Fitting room",ru:"–ø—Ä–∏–º–µ—Ä–æ—á–Ω–∞—è",uz:"kabina"},
    {en:"Size",ru:"—Ä–∞–∑–º–µ—Ä",uz:"o‚Äòlcham"},
    {en:"Color",ru:"—Ü–≤–µ—Ç",uz:"rang"},
    {en:"Cashier",ru:"–∫–∞—Å—Å–∏—Ä",uz:"kassir"},
    {en:"Customer",ru:"–∫–ª–∏–µ–Ω—Ç",uz:"mijoz"},
    {en:"Queue",ru:"–æ—á–µ—Ä–µ–¥—å",uz:"navbat"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 18: –ß—É–≤—Å—Ç–≤–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è", words:[
    {en:"Happy",ru:"—Å—á–∞—Å—Ç–ª–∏–≤—ã–π",uz:"xursand"},
    {en:"Sad",ru:"–≥—Ä—É—Å—Ç–Ω—ã–π",uz:"xafa"},
    {en:"Angry",ru:"—Å–µ—Ä–¥–∏—Ç—ã–π",uz:"jahli chiqqan"},
    {en:"Tired",ru:"—É—Å—Ç–∞–≤—à–∏–π",uz:"charchagan"},
    {en:"Bored",ru:"—Å–∫—É—á–∞—é—â–∏–π",uz:"zerikkan"},
    {en:"Excited",ru:"–≤–∑–≤–æ–ª–Ω–æ–≤–∞–Ω–Ω—ã–π",uz:"hayajonlangan"},
    {en:"Surprised",ru:"—É–¥–∏–≤–ª—ë–Ω–Ω—ã–π",uz:"hayron"},
    {en:"Scared",ru:"–∏—Å–ø—É–≥–∞–Ω–Ω—ã–π",uz:"qo‚Äòrqqan"},
    {en:"Nervous",ru:"–Ω–µ—Ä–≤–Ω—ã–π",uz:"asabiy"},
    {en:"Hungry",ru:"–≥–æ–ª–æ–¥–Ω—ã–π",uz:"och"},
    {en:"Thirsty",ru:"—Ö–æ—á—É—â–∏–π –ø–∏—Ç—å",uz:"chanqagan"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 19: –ß–∞—Å—Ç–∏ —Ç–µ–ª–∞", words:[
    {en:"Head",ru:"–≥–æ–ª–æ–≤–∞",uz:"bosh"},
    {en:"Face",ru:"–ª–∏—Ü–æ",uz:"yuz"},
    {en:"Hair",ru:"–≤–æ–ª–æ—Å—ã",uz:"soch"},
    {en:"Eye",ru:"–≥–ª–∞–∑",uz:"ko‚Äòz"},
    {en:"Ear",ru:"—É—Ö–æ",uz:"quloq"},
    {en:"Nose",ru:"–Ω–æ—Å",uz:"burun"},
    {en:"Mouth",ru:"—Ä–æ—Ç",uz:"og‚Äòiz"},
    {en:"Tooth",ru:"–∑—É–±",uz:"tish"},
    {en:"Hand",ru:"—Ä—É–∫–∞",uz:"qo‚Äòl"},
    {en:"Arm",ru:"–ø—Ä–µ–¥–ø–ª–µ—á—å–µ",uz:"bilak"},
    {en:"Finger",ru:"–ø–∞–ª–µ—Ü",uz:"barmoq"},
    {en:"Leg",ru:"–Ω–æ–≥–∞",uz:"oyoq"},
    {en:"Foot",ru:"—Å—Ç–æ–ø–∞",uz:"oyoq panjasi"},
    {en:"Knee",ru:"–∫–æ–ª–µ–Ω–æ",uz:"tizza"},
    {en:"Back",ru:"—Å–ø–∏–Ω–∞",uz:"orqa"},
    {en:"Shoulder",ru:"–ø–ª–µ—á–æ",uz:"yelka"},
    {en:"Stomach",ru:"–∂–∏–≤–æ—Ç",uz:"qorin"}
  ], completed:false, lastPercent:0 },

  { title:"–£—Ä–æ–∫ 20: –ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–µ —Ñ—Ä–∞–∑—ã", words:[
    {en:"Where is ...?",ru:"–≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è",uz:"... qayerda?"},
    {en:"How much is it?",ru:"—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ —Å—Ç–æ–∏—Ç",uz:"bu qancha turadi?"},
    {en:"I don't understand",ru:"—è –Ω–µ –ø–æ–Ω–∏–º–∞—é",uz:"men tushunmayman"},
    {en:"Please speak slowly",ru:"–ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≥–æ–≤–æ—Ä–∏—Ç–µ –º–µ–¥–ª–µ–Ω–Ω–æ",uz:"iltimos, sekinroq gapiring"},
    {en:"Could you repeat?",ru:"–Ω–µ –º–æ–≥–ª–∏ –±—ã –≤—ã –ø–æ–≤—Ç–æ—Ä–∏—Ç—å",uz:"qaytadan ayta olasizmi?"},
    {en:"Can you help me?",ru:"–≤—ã –º–æ–∂–µ—Ç–µ –º–Ω–µ –ø–æ–º–æ—á—å",uz:"menga yordam bera olasizmi?"},
    {en:"I'm sorry",ru:"–º–Ω–µ –∂–∞–ª—å",uz:"uzr"},
    {en:"Thank you",ru:"—Å–ø–∞—Å–∏–±–æ",uz:"rahmat"},
    {en:"Excuse me",ru:"–∏–∑–≤–∏–Ω–∏—Ç–µ",uz:"kechirasiz"},
    {en:"See you later",ru:"—É–≤–∏–¥–∏–º—Å—è –ø–æ–∑–∂–µ",uz:"keyinroq ko‚Äòrishamiz"},
    {en:"What time is it?",ru:"–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å",uz:"soat nechchi?"},
    {en:"I need ...",ru:"–º–Ω–µ –Ω—É–∂–Ω–æ",uz:"menga ... kerak"},
    {en:"I want ...",ru:"—è —Ö–æ—á—É",uz:"men ... xohlayman"}
  ], completed:false, lastPercent:0 },
];

// ====== –ü–û–õ–ï–ó–ù–û–ï ======
const lessonsGrid = document.getElementById("lessonsGrid");
const mainPage = document.getElementById("mainPage");
const lessonPage = document.getElementById("lessonPage");
const testPage = document.getElementById("testPage");
const summaryPage = document.getElementById("summaryPage");

const lessonTitle = document.getElementById("lessonTitle");
const lessonBadge = document.getElementById("lessonBadge");
const wordList = document.getElementById("wordList");
const startTestBtn = document.getElementById("startTestBtn");
const backToMain1 = document.getElementById("backToMain1");
const backToMain2 = document.getElementById("backToMain2");
const againBtn = document.getElementById("againBtn");

const testPrompt = document.getElementById("testPrompt");
const testForm = document.getElementById("testForm");
const testInput = document.getElementById("testInput");
const testFeedback = document.getElementById("testFeedback");
const skipBtn = document.getElementById("skipBtn");
const stopTestBtn = document.getElementById("stopTestBtn");
const testPos = document.getElementById("testPos");

const sumCorrect = document.getElementById("sumCorrect");
const sumWrong = document.getElementById("sumWrong");
const sumPercent = document.getElementById("sumPercent");
const resetBtn = document.getElementById("resetBtn");

let currentLessonIndex = 0;
let currentLesson = null;
let testIndex = 0, correct = 0, wrong = 0;

// ====== –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ / –∑–∞–≥—Ä—É–∑–∫–∞ ======
function saveProgress(){
  localStorage.setItem("a1_lessons_progress", JSON.stringify(lessons.map(l=>({
    completed:l.completed, lastPercent:l.lastPercent
  }))));
}
function loadProgress(){
  const saved = localStorage.getItem("a1_lessons_progress");
  if(!saved) return;
  try{
    const parsed = JSON.parse(saved);
    if (Array.isArray(parsed) && parsed.length === lessons.length){
      parsed.forEach((p,i)=>{
        lessons[i].completed = !!p.completed;
        lessons[i].lastPercent = Number(p.lastPercent||0);
      });
    }
  }catch{}
}
loadProgress();

// ====== –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ======
function normalize(str){
  return String(str || "")
    .toLowerCase()
    .replace(/[.,!?;:()¬´¬ª"']/g,"")
    .replace(/\s+/g," ")
    .trim();
}

// ====== UI ======
function showSection(sec){
  [mainPage,lessonPage,testPage,summaryPage].forEach(s=>s.classList.remove("active"));
  sec.classList.add("active");
}

function renderLessons(){
  lessonsGrid.innerHTML = "";
  lessons.forEach((l,i)=>{
    const locked = (i>0 && !lessons[i-1].completed);
    const card = document.createElement("div");
    card.className = "card" + (locked ? " locked" : "");

    const title = document.createElement("div");
    title.className = "title";
    title.textContent = l.title;

    const subtitle = document.createElement("div");
    subtitle.className = "subtitle";
    subtitle.textContent = locked ? "–û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ—Å–ª–µ 100% –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–∫–∞" : "–ì–æ—Ç–æ–≤ –∫ –∏–∑—É—á–µ–Ω–∏—é";

    const progress = document.createElement("div");
    progress.className = "progress";
    const fill = document.createElement("div");
    fill.className = "fill";
    fill.style.width = (l.lastPercent||0) + "%";
    progress.appendChild(fill);

    const row = document.createElement("div");
    row.className = "row";
    const percent = document.createElement("span");
    percent.className = "badge";
    percent.textContent = (l.lastPercent||0) + "%";
    const status = document.createElement("span");
    status.className = "badge";
    status.textContent = l.completed ? "–ó–∞–≤–µ—Ä—à—ë–Ω ‚úÖ" : "–ù–µ –∑–∞–≤–µ—Ä—à—ë–Ω";
    row.append(percent,status);

    card.append(title,subtitle,progress,row);
    if(!locked){
      card.addEventListener("click",()=>openLesson(i));
    }
    lessonsGrid.appendChild(card);
  });
}

function openLesson(index){
  currentLessonIndex = index;
  currentLesson = lessons[index];
  lessonTitle.textContent = currentLesson.title;
  lessonBadge.textContent = `–°–ª–æ–≤: ${currentLesson.words.length} ‚Ä¢ –ü—Ä–æ–≥—Ä–µ—Å—Å: ${currentLesson.lastPercent||0}%`;
  wordList.innerHTML = currentLesson.words.map(w=>`<div class="word">${w.en} ‚Äî ${w[currentLang]}</div>`).join("");
  showSection(lessonPage);
}

function startTest(){
  correct = 0; wrong = 0; testIndex = 0;
  testFeedback.style.display = "none";
  renderTestWord();
  showSection(testPage);
}

function renderTestWord(){
  const w = currentLesson.words[testIndex];
  testPos.textContent = `${testIndex+1} / ${currentLesson.words.length}`;
  testPrompt.innerHTML = `<div class="word"><b>${w[currentLang]}</b></div>`;
  testInput.value = "";
  testInput.focus();
}

testForm.addEventListener("submit", (e)=>{
  e.preventDefault();
  const w = currentLesson.words[testIndex];
  if (normalize(testInput.value) === normalize(w.en)){
    testFeedback.textContent = "–í–µ—Ä–Ω–æ!";
    testFeedback.className = "feedback correct";
    correct++;
  }else{
    testFeedback.textContent = `–ù–µ–≤–µ—Ä–Ω–æ! –ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${w.en}`;
    testFeedback.className = "feedback wrong";
    wrong++;
  }
  testFeedback.style.display = "block";
  setTimeout(()=>{
    testIndex++;
    if(testIndex >= currentLesson.words.length){
      finishLesson();
    }else{
      testFeedback.style.display = "none";
      renderTestWord();
    }
  }, 600);
});

skipBtn.addEventListener("click", ()=>{
  testIndex++;
  if(testIndex >= currentLesson.words.length){
    finishLesson();
  }else{
    testFeedback.style.display = "none";
    renderTestWord();
  }
});

function finishLesson(){
  const percent = Math.round((correct / currentLesson.words.length) * 100);
  currentLesson.lastPercent = percent;
  currentLesson.completed = percent === 100; // –∑–∞–≤–µ—Ä—à—ë–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ 100%
  saveProgress();
  // –ü–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ–¥–∫—É
  sumCorrect.textContent = correct;
  sumWrong.textContent = wrong;
  sumPercent.textContent = percent + "%";
  renderLessons();
  showSection(summaryPage);
}

document.getElementById("backToMain1").addEventListener("click",()=>showSection(mainPage));
document.getElementById("backToMain2").addEventListener("click",()=>showSection(mainPage));
document.getElementById("againBtn").addEventListener("click",()=>startTest());
document.getElementById("startTestBtn").addEventListener("click",()=>startTest());
document.getElementById("stopTestBtn").addEventListener("click",()=>showSection(lessonPage));

resetBtn.addEventListener("click", ()=>{
  if(confirm("–¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?")){
    lessons.forEach(l=>{ l.completed=false; l.lastPercent=0; });
    saveProgress();
    renderLessons();
    showSection(mainPage);
  }
});

// –ü–µ—Ä–≤–∏—á–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä
renderLessons();
setLangUI();
</script>
</body>
</html>
